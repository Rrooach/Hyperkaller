include <linux/fcntl.h>
include <linux/ioctl.h>

resource fdcput[int32]: -1
open$IOCTL_PRIVCMD_HYPERCALLcput(file ptr[in, string["/proc/xen/privcmd"]]) fdcput

ioctl$IOCTL_PRIVCMD_HYPERCALLcput0(fd fdcput, ioctl_privcmd_hypecall0 const[0x305000], hypercall ptr[in, my_hypercallcput0])
ioctl$IOCTL_PRIVCMD_HYPERCALLcput1(fd fdcput, ioctl_privcmd_hypecall0 const[0x305000], hypercall ptr[in, my_hypercallcput1])
ioctl$IOCTL_PRIVCMD_HYPERCALLcput2(fd fdcput, ioctl_privcmd_hypecall0 const[0x305000], hypercall ptr[in, my_hypercallcput2])
ioctl$IOCTL_PRIVCMD_HYPERCALLcput3(fd fdcput, ioctl_privcmd_hypecall0 const[0x305000], hypercall ptr[in, my_hypercallcput3])

close$IOCTL_PRIVCMD_HYPERCALLcput(fd fdcput)

my_hypercallcput0 {
	__HYPERVISOR_hypercall_type	const[4, int64]
	args				array[int64, 5]
}

my_hypercallcput1 {
	__HYPERVISOR_hypercall_type	const[0, int64]
	args				array[int64, 5]
}

my_hypercallcput2 {
	__HYPERVISOR_hypercall_type	const[15, int64]
	args				array[int64, 5]
}

my_hypercallcput3 {
	__HYPERVISOR_hypercall_type	const[29, int64]
	args				array[int64, 5]
}
